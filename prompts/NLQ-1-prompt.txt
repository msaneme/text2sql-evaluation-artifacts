""" 
### Instructions:
Your task is to convert a question into a SQL query, given a Postgres database schema.
Adhere to these rules:
- **Deliberately go through the question and database schema word by word** to appropriately answer the question
- When creating a ratio, always cast the numerator as float
- When the identifier of a table field is enclosed in quotation marks (e.g. “entityName”) its use in the query must also be enclosed in quotation marks.

### Input:
Generate a SQL query that answers the question `list of detected anomalies grouped by the collar in which they occurred.`.
This query will run on a database whose schema is represented in this string:
CREATE TABLE collar (
  "time" TEXT, -- Timestamp of the specific measurement, indicated as Unix Epoch format
  "entityName" TEXT, -- Unique ID for each collar
  scenario TEXT, -- ID of the actuation scenario in which the collar has been deployed
  provider TEXT, -- ID of the device provider
  service TEXT, -- Service provided by the device
  type TEXT, -- Type of device (this field always has the value “collar”)
  latitude NUMERIC, -- Latitude coordinate of the geoposition of the device at the specific timestamp of measurement generation
  longitude NUMERIC, -- Longitude coordinate of the geoposition of the device at the specific timestamp of measurement generation
  altitude NUMERIC, -- Altitude coordinate of the geopositioning of the device at the specific timestamp of measurement generation
  geohash TEXT, -- Geohash that express the geoposition of the device at the specific timestamp of measurement generation
  "accX" NUMERIC, -- X-axis accelerometer value
  "accY" NUMERIC, -- Y-axis accelerometer value
  "accZ" NUMERIC, -- Z-axis accelerometer value
  "activityAnomaly" BOOLEAN,  -- Boolean for the identification of activity anomalies
  "distanceAnomaly" BOOLEAN,  -- Boolean for the identification of distance anomalies
  "positionAnomaly" BOOLEAN,  -- Boolean for the identification of position anomalies
  "locationAnomaly" BOOLEAN,  -- Boolean for the identification of location anomalies
  "temperatureAnomaly" BOOLEAN,  -- Boolean for the identification of temperature anomalies
  "resourceAlarm" BOOLEAN,  -- Boolean for alarm identification in the device
  "sequenceNumber" INTEGER, -- Sequence number of the measurement with respect to the other measurements generated by the same device
  temperature NUMERIC, -- Temperature value generated by the device
  CONSTRAINT key PRIMARY KEY ("entityName", "time")
);

### Response:
Based on your instructions, here is the SQL query I have generated to answer the question `list of detected anomalies grouped by the collar in which they occurred.`:
sql
"""